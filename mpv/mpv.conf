#
# contact : mail@muratcansimsek.com.tr
#

#
# mpv configurations
#
# for mpv v0.16.0 or newer with vapoursynth, ffms2, subliminal
# and mvtools (last change, 2 june 2016)
#
# you can copy all of this file into ~/.config/mpv/mpv.conf
#
# the other necessary config files are also included inside, but commented out.
# you need to copy them into their own files as instructed and comment out
# the lines as you like.
#

#
# input settings
#
# input settings live in ~/.config/mpv/input.conf
#
# first four line disables trackpad swiping, otherwise mpv detects trackpad
# gestures as commands and creates a mess. this fixes it. clicking still works.
#
# AXIS_UP    ignore
# AXIS_DOWN  ignore
# AXIS_LEFT  ignore
# AXIS_RIGHT ignore
#
# following disables mpv's fullscreen controls and leaves it for
# os x's window manager. this way, you can use native os x fullscreen
# but there would be no shortcuts. you can use window buttons without these
# too, but i find that double clicking to fullscreen usually happens reflexively,
# so i disabled it.
#
# f ignore
# MOUSE_BTN0_DBL ignore
#
# following line makes open source vapoursynth solution optional, more about it later.
#
# P vf toggle vapoursynth=~/.config/mpv/vapoursynth/interpolation.py
#
# following line enables and disables bs2b, a filter to turn sound into
# binaural, which improves listening with headphones. ffmpeg must be installed
# with --with-libbs2b to use this.
#
# H af toggle lavfi=[bs2b=profile=jmeier]
#

#
# OSC settings
#
# on screen control settings live in ~/.config/mpv/lua-settings/osc.conf
#
# valign line carries the osc to the top of the screen so that it would
# not cover the subtitles. others are self-explanatory. you also might
# like to check the manual for additional layout and seekbar styles.
# the ones i used are the most minimalistic ones.
#
# layout=slimbox
# valign=-1
# boxalpha=160
# hidetimeout=1000
# seekbarstyle=bar
#

#
# for the details of 60 fps playback check here:
#
# < https://redd.it/4ljbdq >
#

#
# mpv settings
#

#
# svp < https://www.svp-team.com >
#
# enable the line below if you are using svp 4 mac. afterwards you can
# use vapoursynth presets or the svp preset.

# input-ipc-server=/tmp/mpvsocket

#
# video
#
# while the highest quality preset is the best quality we can
# get without 60 fps, it will kill your cpu with older retina screens and
# macbook airs. therefore we have other presets too. use the high with
# macbook air and the medium with older retina screens. highest quality
# would be fine with them if hardware acceleration works, but it
# doesn't work with all the formats.
#
# important thing to note here is that we have seperate presets for
# 60 fps playback with vapoursynth solutions. the usual presets are too demanding
# on cpu and vapoursynth can't work well with them. if you want to use
# vapoursynth, just disable all the others and enable the ones below. the
# difference between highest and high is debanding. medium uses a faster
# scaling algorithm compared to high. instead of using low, you might be
# better of with vlc.
#
# there is also a special svp preset. but only use it if you want to use
# svp's scaling. this preset doesn't do scaling. it is similar to highest
# quality vapoursynth preset, but without scaling as svp has an option
# to handle it.
#
# if you want to use vapoursynth with other presets, you need to disable
# hwdec, video-sync and remove interpolation. removing
# debanding might also help quite a lot.
#
# also remember that mpv uses its own frame interpolation in non-vapoursynth
# presets. it isn't real 60 fps, but still good. and sometimes works better
# with films. if you want to use one of those presets, but without interpolation,
# leave video-sync line commented out. that would disable the interlopation.
# check the link below for more information:
#
# < https://github.com/mpv-player/mpv/wiki/Interpolation >
#
# non-vapoursynth, highest quality preset is the default one.
# if you have problems, downgrade one-by-one.
#


#
# display
#
# to autofit-larger, you can also write your screen resolution, works better
# with fullscreen playback. if you don't know it, check here:
# < http://www.whatismyscreenresolution.com >. one thingto note is:
# svp already does this, so you can disable this line if you use
# svp or disable this feature of svp. i haven't tested which one works better.
#
# set fs line to *yes* if you want to start with mpv's non-native fullscreen.
# others are all easy to understand.
#

# autofit-larger=100%x95%

# deinterlace=auto

# fs=no
# force-window=immediate
# stop-screensaver
# cursor-autohide=1000
# osd-font='Helvetica Neue'

#
# sound
#
# softvol controls mpv's volume settings, here it is disabled and left for
# os x's mixer. set audio channels as needed. this is fine for headphones.
#

# audio-fallback-to-null=yes
# audio-pitch-correction=no
# ao=coreaudio:change-physical-format=yes
# af=rubberband
# audio-channels=2
# audio-file-auto=fuzzy

#
# if you are using the amazing volume mixer < http://www.volumemixer-app.com >
# enable the line below. they are not fully compatible yet, but this a working fix.
# if it still doesn't work check the right audio-device
# by this command: < mpv --audio-device=help >.
#

# audio-device=coreaudio/VOLUMEMIXER01

#
# enable the line below to make bauer stereo to binaural transformation default,
# which improves headphone listening of stereo audio. ffmpeg must be installed
# with --with-libbs2b to use this.
#
# af=lavfi=[bs2b=profile=jmeier]

#
# subtiles, with crunchyroll defaults.
#
# i have choosen cr defaults since they are familiar
# and everyone should have the typeface.
#
# sub-codepage is the subtitle encoding. check the wiki page for your language
# and change the second one: https://en.wikipedia.org/wiki/windows_code_page#list
#

# sub-codepage=utf8:cp1252

# alang=jp,jpn
# slang=en,enus

# sub-text-font='Trebuchet MS'
# sub-text-border-size=1
# sub-text-font-size=54
# sub-text-margin-y=38

# embeddedfonts=yes
# demuxer-mkv-subtitle-preroll
# sub-auto=fuzzy
# ass-vsfilter-aspect-compat=yes
# ass-force-style=Kerning=yes

#
# scripts
#
# mpv can load lua scripts to do various things, here is a compendium
# of some scripts: https://github.com/mpv-player/mpv/wiki/user-scripts
#
# scripts are installed under ~/.config/mpv/scripts
#

script=~/.config/mpv/scripts/autosub.lua,~/.config/mpv/scripts/autoload.lua,~/.config/mpv/scripts/stats.lua

#
# stats.lua -> https://raw.githubusercontent.com/slyneth/mpv-stats/master/stats.lua
#
# displays some statistics about the currently played file on-screen with i.
#
# autoload.lua -> https://raw.githubusercontent.com/mpv-player/mpv/master/tools/lua/autoload.lua
#
# automatically loads playlist entries before and after the currently
# playing file, by scanning the directory.
#
# this is the script ~/.config/mpv/scripts/autosub.lua :
#
# this script is to download subtitles automatically using
# subliminal. to search subtitles, use the key b. you change subtitles
# with j and open/close them with v. if you want to change the subtitle
# language, change en in the t.args line.
#
# -- requires subliminal, version 1.0 or newer
# -- default keybinding: b
# local utils = require 'mp.utils'
# function load_sub_fn()
#     subl = "/usr/local/bin/subliminal" -- use 'which subliminal' to find the path
#     mp.msg.info("searching subtitle")
#     mp.osd_message("searching subtitle")
#     t = {}
#     t.args = {subl, "download", "-s", "-l", "en", mp.get_property("path")}
#     res = utils.subprocess(t)
#     if res.status == 0 then
#         mp.commandv("rescan_external_files", "reselect")
#         mp.msg.info("subtitle download succeeded")
#         mp.osd_message("subtitle download succeeded")
#     else
#         mp.msg.warn("subtitle download failed")
#         mp.osd_message("subtitle download failed")
#     end
# end
#
# mp.add_key_binding("b", "auto_load_subs", load_sub_fn)
#

#
# misc.
#
# save-position-on-quit will save the current playback position on quit.
# when this file is played again later, the player will seek to the old
# playback position on start. works with streaming too.
#
# we use .jpg with screenshots because .png takes to much space. if you want
# to use .png disable the screenshot-jpeg-quality line and set screenshot-format
# to png.
#
# input-media-keys controls whether or not mpv will have control over media
# keys. set it to *yes* if you want to use them with mpv.
#
# cache-default determines how much of the video file will be cached
# while streaming. here it is set to 578.3 mbs. while this seems much, it is
# actually just enough to cache 1080p anime episodes entirely so that you
# could continue watching if you experience network problems.
#
# cache-pause pauses the playback when cache is empty, this is cleaner.
#
# cache-initial determines how long to wait before playback, filling
# the cache. these are all on kbs.
#

# save-position-on-quit

# screenshot-format=jpg
# screenshot-jpeg-quality=95
# screenshot-template=~/downloads/mpv_%f_%p
# screenshot-tag-colorspace=yes

# input-media-keys=no

# cache-default=600000
# cache-initial=4096
# cache-pause

#
# end
#

# David options
# save-position-on-quit
# no-border                               # no window title bar
msg-module                              # prepend module name to log messages
msg-color                               # color log messages on terminal
term-osd-bar                            # display a progress bar on the terminal
use-filedir-conf                        # look for additional config files in the directory of the opened file
# pause                                   # no autoplay
# keep-open                               # keep the player open when a file's end is reached
framedrop=vo                            # drop frames in case your computer is to slow for realtime playback
autofit-larger=100%x95%                 # resize window in case it's larger than W%xH% of the screen
deinterlace=auto                        # 'auto' does not imply interlacing-detection
cursor-autohide-fs-only                 # don't autohide the cursor in window mode, only fullscreen
input-media-keys=yes                    # enable/disable OSX media keys
cursor-autohide=1000                    # autohide the curser after 1s
fs-black-out-screens

screenshot-format=png
screenshot-png-compression=8
screenshot-template='~/Desktop/%F (%P) %n'

hls-bitrate=max                         # use max quality for HLS streams
ytdl-raw-options=format="(bestvideo+bestaudio[height>=?1080]/best)[protocol!=rtmp]"

#############
# OSD / OSC #
#############
osc                                     # activate on screen controls

osd-level=1                             # enable osd and display --osd-status-msg on interaction
osd-duration=2500                       # hide the osd after x ms
osd-status-msg='${time-pos} / ${duration}${?percent-pos:　(${percent-pos}%)}${?vo-drop-frame-count:${!vo-drop-frame-count==0:　Dropped: ${vo-drop-frame-count}}}\n${?chapter:Chapter: ${chapter}}'

osd-font='Hiragino Maru Gothic Pro'
osd-font-size=32
osd-color='#CCFFFFFF'                   # ARGB format
osd-border-color='#99000000'            # ARGB format
# osd-shadow-offset=1                     # pixel width for osd text and progress bar
osd-bar-align-y=0                       # progress bar y alignment (-1 top, 0 centered, 1 bottom)
osd-border-size=1                       # size for osd text and progress bar
osd-bar-h=2                             # height of osd bar as a fractional percentage of your screen height
osd-bar-w=60                            # width of " " "

#############
# Subtitles #
#############

demuxer-mkv-subtitle-preroll            # try to correctly show embedded subs when seeking
sub-auto=fuzzy                          # external subs don't have to match the file name exactly to autoload
sub-paths=ass:srt:sub:subs:subtitles    # search for external subs in the listed subdirectories
embeddedfonts=yes                       # use embedded fonts for SSA/ASS subs
sub-fix-timing=no                       # do not try to fix gaps (which might make it worse in some cases)
sub-ass-force-style=Kerning=yes         # allows you to override style parameters of ASS scripts

# the following options only apply to subtitles without own styling (i.e. not ASS but e.g. SRT)
sub-font="Source Sans Pro Semibold"
sub-font-size=52
sub-color="#FFFFFFFF"
sub-border-color="#FF262626"
sub-border-size=2.0
sub-shadow-offset=1
sub-shadow-color="#33000000"
sub-spacing=0.5


#############
# Languages #
#############

slang=enm,en,eng             # automatically select these subtitles (decreasing priority)
alang=jp,jpn,en,eng          # automatically select these audio tracks (decreasing priority)

# Choose best hardware decoder available. [--hwdec=no] to deactivate
hwdec=auto

# Settings for SVP
# hwdec=auto-copy
hwdec-codecs=all
